<div class="container-fluid my-4">
    <div class="row mb-3 align-items-center">
        <div class="col-4">
            <%= button_to raw('<i class="bi bi-arrow-left"></i> å‰æœˆ'), calendar_path(@date.beginning_of_month << 1), {method: :get, class: "btn btn-sm btn-outline-secondary"} %>
        </div>
        <div class="col-4 text-center">
          <h2 class="h4 mb-0"><%= @date.strftime("%Yå¹´ %mæœˆ")%></h2>
        </div>
        <div class="col-4 text-end">
            <%= button_to raw('æ¬¡æœˆ <i class="bi bi-arrow-right"></i>'), calendar_path(@date.beginning_of_month >> 1), {method: :get, class: "btn btn-sm btn-outline-secondary"} %>
        </div>
    </div>

     <%#æ›œæ—¥ãƒ˜ãƒƒãƒ€ãƒ¼ (7åˆ—)%>
    <div class="row row-cols-7 g-0 text-center fw-bold border-bottom border-top">
        <div class="col py-2 text-danger">æ—¥</div>
        <div class="col py-2">æœˆ</div>
        <div class="col py-2">ç«</div>
        <div class="col py-2">æ°´</div>
        <div class="col py-2">æœ¨</div>
        <div class="col py-2">é‡‘</div>
        <div class="col py-2 text-primary">åœŸ</div>
        <div class="col-auto week-total-cell border-end border-bottom"></div>
    </div>

  <% @count=0 %>
  <%# ğŸ’¡ é€±ã®ãƒ«ãƒ¼ãƒ— %>
  <% @weeks.each_with_index do |week_days, week_index| %>
    <% @count=@count+1 %>

    <%# 1. é€±å…¨ä½“ã®è¡Œ (Bootstrap row) %>
    <div class="row g-0 border-bottom">

      <%# 2. æ—¥ä»˜ã‚»ãƒ«ã®ãƒ«ãƒ¼ãƒ— %>
      <% week_days.each do |day| %>
        <% is_day_red = false %>
        <% @calendar_price_related_food_top5.each do |top5_day| %>
          <% is_day_red = true if day == top5_day %>
        <% end %>

        <%# ãã®æœˆã®æ—¥ä»˜ã‹ã©ã†ã‹ã§è‰²ã‚’å¤‰ãˆã‚‹ %>
        <% is_current_month = day.month == @date.month %>

        <div class="col <%= is_day_red ? 'kakeibo-day-cell-red' : 'kakeibo-day-cell' %> <%= is_current_month ? '' : 'text-muted' %> border-start border-end">
          <% if day >= @date.beginning_of_month and day <= @date.end_of_month %>
            <div class="day-header">
              <%# æ—¥ä»˜ã®æ•°å­—ã‚’è¡¨ç¤º %>
              <span><%= link_to day.day, daily_result_path(day) %></span>
            </div>

            <div class="item-area">
                <div class="item-row d-flex justify-content-between">
                  <span>é£Ÿè²»</span><span>Â¥ <%= @calendar_price_related_food[day] %></span>
                </div>
                <div class="item-row d-flex justify-content-between">
                <span>ä»–</span><span>Â¥ <%= @calendar_price_except_food[day] %></span>
                </div>
            </div>

            <div class="day-total">
              <span>åˆè¨ˆ</span><span>Â¥ <%= [@calendar_price_related_food[day], @calendar_price_except_food[day]].sum %></span>
            </div>
           <% end %>
        </div>
      <% end %>

        <%# ğŸ’¡ é€±ã®åˆè¨ˆæ¬„ %>
        <div class="col-auto week-total-cell d-flex flex-column justify-content-center">
          <h6 class="fw-bold mb-1">ç¬¬ <%= @count %> é€±ã®åˆè¨ˆ</h6>
            <div class="item-row d-flex justify-content-between">
              <span class="text-nowrap">é£Ÿè²»åˆè¨ˆ</span><span class="fw-bold">Â¥ <%= @weekly_price_related_food[@count-1] %></span>
            </div>
            <div class="item-row d-flex justify-content-between">
                <span class="text-nowrap">ãã®ä»–åˆè¨ˆ</span><span class="fw-bold">Â¥ <%= @weekly_price_except_food[@count-1] %></span>
            </div>
            <hr class="my-1">
            <div class="item-row d-flex justify-content-between">
              <span class="text-nowrap">åˆè¨ˆ</span><span class="fw-bold text-danger">Â¥ <%= [@weekly_price_related_food[@count-1], @weekly_price_except_food[@count-1]].sum %></span>
            </div>
        </div>
      </div>
  <% end %>
</div>

